# 文档自动提取关键信息系统

## 功能说明

本系统可以自动处理本地文档（Word、PDF），识别文档类型，提取关键信息，并将结果存储到对应的Excel表格中。

系统主要功能包括：
1. **文档分类**：自动识别文档类型（办会材料信息、办文材料信息、政策文件信息）
2. **信息提取**：从文档中提取关键信息字段
3. **问答对生成**：基于政策文件自动生成问答对，符合政府用词用语习惯，同时便于老百姓理解

## 快速开始

### 1. 环境准备

```bash
# 激活 conda 环境
conda activate big-data-doc-auto-shell

# 确保已安装依赖
pip install -e .
```

### 2. 配置检查

确保 `.env` 文件已正确配置：
- `OPENAI_API_KEY`: API密钥
- `OPENAI_BASE_URL`: API地址
- `MODEL_NAME`: 模型名称

### 3. 运行程序

#### 3.1 文档处理（提取关键信息）

```bash
python main.py
```

#### 3.2 生成政策问答对

在完成文档处理后，可以基于政策文件生成问答对：

```bash
python generate_qa.py
```

该程序会：
- 读取 `output/4政策文件信息.xlsx` 中的政策记录
- 为每个政策生成 10 个问答对
- 将问答对保存到 `output/5政策问答对.xlsx`

## 使用说明

1. 将待处理的文档放入 `data/` 目录
2. 运行 `python main.py`
3. 程序会自动：
   - 扫描 `data/` 目录下的所有 Word 和 PDF 文件
   - 使用 LLM 对文档进行分类
   - 提取关键信息
   - 将结果保存到 `output/` 目录对应的 Excel 文件中

## 输出文件

处理后的数据会保存在 `output/` 目录：
- `2办会材料信息.xlsx` - 办会材料
- `3办文材料信息.xlsx` - 办文材料
- `4政策文件信息.xlsx` - 政策文件
- `5政策问答对.xlsx` - 政策问答对（需运行 `generate_qa.py` 生成）

## 日志

- `processing.log` - 文档处理日志（main.py）
- `qa_generation.log` - 问答对生成日志（generate_qa.py）

## 政策问答对生成说明

### 功能特点

- **自动生成**：基于政策文件信息自动生成 10 个问答对
- **风格平衡**：符合政府用词用语习惯，同时便于老百姓理解
- **内容全面**：涵盖政策适用范围、申请条件、办理流程、所需材料等多个方面

### 使用前提

在运行 `generate_qa.py` 之前，需要先运行 `main.py` 处理文档，确保 `output/4政策文件信息.xlsx` 文件已生成并包含政策记录。

### 问答对字段说明

- **XH**：序号（自动递增）
- **ID**：关联的政策文件ID
- **SourceDepartment**：来源部门（责任部门或发布单位）
- **Problem**：问题（老百姓关心的实际问题）
- **Answer**：答案（基于政策文件的准确回答）
- **PolicyName**：政策名称
- **DocumentNumber**：发文文号
- **Fields**：涉及领域
- **Remarks**：备注

